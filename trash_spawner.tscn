[gd_scene load_steps=3 format=3 uid="uid://53p2ve2asr0v"]

[ext_resource type="PackedScene" uid="uid://b77d384mf8au1" path="res://trash_item.tscn" id="1_o4tsm"]

[sub_resource type="GDScript" id="GDScript_lpccn"]
script/source = "extends Node3D

@export var trash_scene: PackedScene
@export var spawn_count: int = 20
@export var radius: float = 80.0

@export var water_level: float = 92.0
@export var seabed_height: float = 40.0

@export var spawn_interval: float = 3.0

var timer := 0.0


func _ready():
	randomize()
	_spawn_wave()


func _process(delta):
	timer -= delta
	if timer <= 0.0:
		_spawn_wave()
		timer = spawn_interval


func _spawn_wave():
	var center = global_transform.origin   # ðŸŒŠ center of sea

	for i in spawn_count:
		var trash = trash_scene.instantiate()

		var angle = randf() * TAU
		var dist  = randf() * radius

		var pos = center + Vector3(
			cos(angle) * dist,
			0,
			sin(angle) * dist
		)

		# Pick depth zone
		var roll := randf()

		if roll < 0.4:
			# FLOATING
			pos.y = water_level - randf_range(0.2, 1.5)

		elif roll < 0.8:
			# MID-DEPTH
			pos.y = randf_range(seabed_height + 3.0, water_level - 2.0)

		else:
			# SEABED
			pos.y = seabed_height + randf_range(0.0, 1.0)
			trash.freeze = true   # stays in place

		# Very slow underwater movement + no spinning
		if trash is RigidBody3D:
			trash.linear_damp = randf_range(3.0, 6.0)
			trash.angular_damp = 10.0
			trash.freeze_mode = RigidBody3D.FREEZE_MODE_KINEMATIC
			trash.freeze = false

		trash.global_transform.origin = pos
		get_parent().add_child(trash)

		print(\"SPAWN:\", pos)
"

[node name="TrashSpawner" type="Node3D"]
script = SubResource("GDScript_lpccn")
trash_scene = ExtResource("1_o4tsm")
spawn_count = 5
spawn_interval = 20.0
